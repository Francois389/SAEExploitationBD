def creation_insertion_sql(ligne: str, text_format: list,
                           table_attribut: dict, nom_table: str, delimiter: str = ";") -> str:
    """
    Ecrit la requete SQL pour inserer dans une Table SQl
    avec les attributs enregistrer dans le dictionnaire table_attribut.

    arguments :
        ligne -> str : la ligne de code à convertir respectant le format text_format
        text_format → list : le format de la ligne du fichier texte
        table_attribut → dict :  Le dictionnaire qui en valeur le nom de l'attribut
                                  et en clé l'équivalent dans le fichier texte
        nom_table → str : le nom de la table SQL
        delimiter → str : le delimiteur de la ligne de code. Par defaut c'est ";"

    retours :
        ligne_retour → str : la ligne de code sql a inserer dans le fichier

    """
    ligne_retour = f"INSERT INTO {nom_table} ("
    for propriete_table in text_format:
        ligne_retour += table_attribut[propriete_table] + ", "
    ligne_retour = ligne_retour[:-2] + ") VALUES ("

    for mot in ligne.split(delimiter):
        try:
            ligne_retour += f"{int(mot)}"
            # print(x)
        except:
            ligne_retour += f"'{mot}'"
            print("An exception occurred")
        ligne_retour += ', '
    return ligne_retour[:-2] + ");"


def lecture_ecriture_fichier_txt(url_source: str, url_destination):
    with open(url_source, "r", encoding="utf8") as source, open(url_destination, "w", encoding="utf8") as destination:
        for ligne in source:
            # TODO Recupérer text_format, table_attribut et nom_table
            # TODO Utiliser la fonction creation_insertion_sql pour creer la requete d'insertion SQL
            # TODO Ecrire la requete dans le fichier source
            pass


if __name__ == "__main__":
    ligne = "B1GEACM;GEA;1"
    text_format = ["groupe", "departement", "annee"]
    table_attribut = {"groupe": "nom_groupe", "departement": "nom_departement", "annee": "annee_etude"}
    nom_table = "GROUPE"
    print(creation_insertion_sql(ligne, text_format, table_attribut, nom_table))
