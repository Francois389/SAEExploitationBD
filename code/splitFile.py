import os

def split(fichier: str, nb_lignes_max=10000):

    if os.path.getsize(fichier) >= 1_750_000:
        nom_petit_fichier = fichier
        compteur = 0

        with open(fichier, encoding="utf-8") as fichier_ouvert:
            for num_ligne, ligne in enumerate(fichier_ouvert.readlines()):
                if num_ligne >= nb_lignes_max:
                    
                    compteur += 1
                
                ajouter_dans_csv(
                    url_file=f"{nom_petit_fichier}",
                    objet=ligne.removesuffix("\n"),
                    newline=True,
                    delimiter=None
                )






def ajouter_dans_csv(url_file: str, objet, newline: bool = True, delimiter: str = None) -> None:
    """
    Ajouter une cellule dans le fichier CSV donné.

    Paramètres :
        url_file    -> Chemin vers le fichier à modifier
        objet       -> Contenu à insérer
        newline     -> Ajout d'une nouvelle ligne ou non
        delimiter   -> Caractère de délimitation des valeurs
    """

    with open(url_file, 'a', encoding='utf-8') as csv:
        if newline:
            csv.writelines(str(objet) + "\n")
            
        else:
            csv.writelines(str(objet))
            csv.writelines(str(delimiter))
