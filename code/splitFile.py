__doc__ = """
fichier possedant la fonction split qui est celle à utiliser
elle permet de vérifier si la taille d'un fichier est supérieure
à 1.75 Mo, si le fichier est effectivement d'une taile supérieure
alors ce fichier est séparé en plusieurs sous fichiers de 5000 lignes
au maximum 
"""
import os

def split(path: str, nom_fichier: str, extension: str):
    """
    fonction permettant de séparer un fichier en plusieurs sous fichiers
    """
    nb_lignes_max=5000
    
    if os.path.getsize(path + nom_fichier + extension) >= 1_750_000:
        nom_petit_fichier = path + nom_fichier + "_{cpt}" + extension
        compteur = 0
        num_ligne = 0
        with open(path + nom_fichier + extension, encoding="utf-8") as fichier_ouvert:
            for ligne in fichier_ouvert.readlines():
                num_ligne += 1
                if num_ligne >= nb_lignes_max:
                    num_ligne = 0
                    compteur += 1
                
                ajouter_dans_csv(
                    url_file=nom_petit_fichier.format(cpt=compteur),
                    objet=ligne.removesuffix("\n"),
                    newline=True,
                    delimiter=None
                )

        os.remove(path + nom_fichier + extension)





def ajouter_dans_csv(url_file: str, objet, newline: bool = True, delimiter: str = None) -> None:
    """
    Ajouter une cellule dans le fichier CSV donné.

    Paramètres :
        url_file    -> Chemin vers le fichier à modifier
        objet       -> Contenu à insérer
        newline     -> Ajout d'une nouvelle ligne ou non
        delimiter   -> Caractère de délimitation des valeurs
    """

    with open(url_file, 'a', encoding='utf-8') as csv:
        if newline:
            csv.writelines(str(objet) + "\n")
            
        else:
            csv.writelines(str(objet))
            csv.writelines(str(delimiter))
