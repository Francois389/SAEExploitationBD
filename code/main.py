import Creneau, Calendrier
import os

calendrier = Calendrier.Calendrier("data\ADECal.ics")

calendrier.get_data()

liste_event = calendrier.get_events()

def addincsv(url_file, objet, newline=True, delimiter=None):
    with open(url_file, 'a', encoding='utf-8') as csv:
        if newline:
            csv.writelines(str(objet) + '\n')
        else:
            csv.writelines(str(objet))
            csv.writelines(str(delimiter))

target = "debug"

try:
    os.remove(f"{target}/les_creneaux.csv")
except:
    pass

addincsv(f"{target}/les_creneaux.csv", "date_debut", newline=False, delimiter=";")
addincsv(f"{target}/les_creneaux.csv", "date_fin", newline=False, delimiter=";")
addincsv(f"{target}/les_creneaux.csv", "intitule", newline=False, delimiter=";")
addincsv(f"{target}/les_creneaux.csv", "salle", newline=False, delimiter=";")
addincsv(f"{target}/les_creneaux.csv", "groupe", newline=False, delimiter=";")
addincsv(f"{target}/les_creneaux.csv", "prenom_prof", newline=False, delimiter=";")
addincsv(f"{target}/les_creneaux.csv", "nom_prof", newline=True, delimiter=";")

for i,creneau in enumerate(liste_event):
    # print(creneau) 
    for obj in creneau.get_data_csv():
        addincsv(f"{target}/les_creneaux.csv", obj, newline=False, delimiter=";")
    addincsv(f"{target}/les_creneaux.csv", "")

    print(f"completion : {i+1}/{len(liste_event)+1}", end="\r")
    
    