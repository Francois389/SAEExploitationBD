import Creneau, Calendrier
import os

calendrier = Calendrier.Calendrier("data/ADECal.ics")

calendrier.get_data()

liste_event = calendrier.get_events()

def addincsv(url_file,objet,newline =True, delimiter =  None):
    csv = open(url_file,'a',encoding='utf-8')
    if newline:
        csv.write((str(objet)+'\n'))
    else:
        csv.write(str(objet))
        csv.write(str(delimiter))
    csv.close()

try:
    os.remove("les_creneaux.csv")
except:
    pass

addincsv("les_creneaux.csv", "date_debut", newline=False, delimiter=";")
addincsv("les_creneaux.csv", "date_fin", newline=False, delimiter=";")
addincsv("les_creneaux.csv", "intitule", newline=False, delimiter=";")
addincsv("les_creneaux.csv", "salle", newline=False, delimiter=";")
addincsv("les_creneaux.csv", "professeur", newline=False, delimiter=";")
addincsv("les_creneaux.csv", "groupe", newline=True, delimiter=";")

for i,creneau in enumerate(liste_event):
    # print(creneau) 
    for obj in creneau.get_data_csv():
        addincsv("les_creneaux.csv", obj, newline=False, delimiter=";")
    addincsv("les_creneaux.csv", "")

    print(f"completion : {i+1}/{len(liste_event)+1}", end="\r")
    
    