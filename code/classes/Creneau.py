import datetime

class Creneau:
    """
    cette classe sert a stocker les informations d'un créneau
    les différentes données sont celles spécifiées dans l'énoncé

    ses différents attributs sont:
        - id_creneau  : str
        - intitule    : str
        - heure_debut : datetime
        - heure_fin   : datetime
    """

    def __init__(self, id: str, intitule: str, debut: str, fin: str) -> None:
        """
        arguments: 
            - id: str -> l'indentifiant unique du créneau (UID dans le fichier ics) 
            - intitule: str -> la description et le nom du créneau
            - debut: str -> la date/heure de début du créneau
            - fin: str -> la date/heure de fin du créneau

        """
        self.id_creneau: str = id
        self.intitule: str = intitule.replace("'", "''")
        self.heure_debut: datetime.datetime = self.get_jour_heure(debut)
        self.heure_fin: datetime.datetime = self.get_jour_heure(fin)

    def get_jour_heure(self, string: str) -> datetime.datetime:
        """
        argument :
            - string: str -> une date formaté que l'on converti en datetime

        retours :
            - date: datetime -> la date

        permet de convertir la 'date' presente dans le fichier ics en tant que string
        en date de type datetime
        """
        date = datetime.datetime.strptime(string, "%Y%m%dT%H%M%SZ")
        
        return date

    def get_identifiant (self) -> str:
        """
        retour :
            - id_creneau: str

        getter permettant de récupérer l'identifiant du créneau
        """
        return self.id_creneau

    def get_intitule (self) -> str: 
        """
        retour :
            - intitule: str

        getter permettant de récupérer l'intitule du créneau
        """
        return self.intitule

    def get_heure_debut (self) -> datetime.datetime: 
        """
        retour :
            - heure_debut: datetime

        getter permettant de récupérer la date de début du créneau
        """        
        return self.heure_debut

    def get_heure_fin (self) -> datetime.datetime: 
        """
        retour :
            - heure_fin: datetime

        getter permettant de récupérer la date de début du créneau
        """
        return self.heure_fin


    def get_colonnes_sql(self) -> tuple[str]:
        """
        retours :
            - tuple contenant les différentes colonnes de la 'table' créneau

        permet de récupérer toutes les colonnes de la table creneau afin de faciliter
        la création des insertions de cette table
        """
        return ("(id_creneau, intitule, heure_debut, heure_fin)")

    def get_valeurs_sql(self) -> tuple[str]:
        """
        retours :
            - tuple contenant les différentes valeurs de la 'table' créneau

        permet de récupérer toutes les valeurs à insérer dans la table creneau afin de faciliter
        la création des insertions de cette table
        """
        return (f"('{self.id_creneau}', '{self.intitule}', '{self.heure_debut}', '{self.heure_fin}')")


    def __eq__(self, arg) -> bool:
        return self.id_creneau == arg.get_identifiant()

    def __gt__(self, arg) -> bool:
        return self.id_creneau > arg.get_identifiant()

    def __lt__(self, arg) -> bool:
        return self.id_creneau < arg.get_identifiant()

    def __str__(self) -> str:
        return f"Creneau: \n\tid: {self.id_creneau} \n\t{self.intitule} \n\tde: {self.heure_debut} \n\tà: {self.heure_fin} "
        
